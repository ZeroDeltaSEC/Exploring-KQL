7let sqlInjectionPatterns = dynamic([
    "' or '1'='1",
    "' OR 1=1 --",
    "'; DROP TABLE",
    "'; EXEC",
    "' UNION SELECT",
    "'--",
    "' OR 'a'='a",
    "' or 1=1--",
    "' or 1=1#",
    "' or 1=1/*"
]);
// Example for SigninLogs (Azure AD/Entra ID logs)
SigninLogs
| where TimeGenerated >= ago(7d)
| where UserPrincipalName has_any(sqlInjectionPatterns) or Identity has_any(sqlInjectionPatterns)
| project TimeGenerated, UserPrincipalName, Identity, IPAddress, AppDisplayName, ResourceDisplayName, ConditionalAccessStatus

let sqlInjectionPatterns = dynamic([
    "' or '1'='1",
    "' OR 1=1 --",
    "'; DROP TABLE",
    "'; EXEC",
    "' UNION SELECT",
    "'--",
    "' OR 'a'='a",
    "' or 1=1--",
    "' or 1=1#",
    "' or 1=1/*"
]);
search *
| where TimeGenerated >= ago(7d)
| where tostring(parse_json(tostring(*))) has_any(sqlInjectionPatterns)
| project TimeGenerated, SourceTable, _ResourceId, Computer, IPAddress, Account, _RawData = *

let sqlInjectionPatterns = dynamic([
    "' or '1'='1",
    "' OR 1=1 --",
    "'; DROP TABLE",
    "'; EXEC",
    "' UNION SELECT",
    "'--",
    "' OR 'a'='a",
    "' or 1=1--",
    "' or 1=1#",
    "' or 1=1/*"
]);
search *
| where TimeGenerated >= ago(7d)
| where * has_any(sqlInjectionPatterns)
// | project TimeGenerated, SourceTable, _ResourceId, Computer, IPAddress, Account, EventData = *


let sqlInjectionPatterns = dynamic([
  "' or '1'='1",
  "-- OR 1=1 --",
  "; DROP TABLE",
  "EXEC",
  "UNION SELECT",
  "--a",
  "OR 'a'='a",
  "or 1=1--",
  "or 1=1#",
  "or 1=1/*"
]);

search *
| where TimeGenerated >= ago(7d)
| where * has_any(sqlInjectionPatterns)

let sqlInjectionPatterns = dynamic([
    "' or '1'='1'",
    "-- OR 1=1 --",
    "; DROP TABLE",
    "EXEC",
    "UNION SELECT",
    "--a",
    "OR 'a'='a'",
    "or 1=1--",
    "or 1=1#",
    "or 1=1/*"
]);
search in (*)
| where TimeGenerated >= ago(7d)
| where tostring(*) has_any sqlInjectionPatterns