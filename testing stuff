7DeviceEvents
| where Timestamp > ago(24h)
| where ActionType in ("ExploitGuardNetworkProtectionBlocked", "ExploitGuardNetworkProtectionAudited")
| extend d = parse_json(AdditionalFields)
| extend Domain   = tostring(d.Domain),
         Url      = tostring(d.Url),
         Category = tostring(d.Category),
         Ip       = tostring(d.Ip)
| project Timestamp, DeviceName, ActionType, Domain, Url, Ip, Category,
          InitiatingProcessAccountName, InitiatingProcessFileName
| order by Timestamp desc



DeviceEvents
| where Timestamp > ago(7d)
| where ActionType in ("ExploitGuardNetworkProtectionBlocked", "ExploitGuardNetworkProtectionAudited")
| extend d = parse_json(AdditionalFields)
| extend Domain = tostring(d.Domain), Url = tostring(d.Url)
| where Domain =~ "badexample.com" or Url has "badexample.com"
| project Timestamp, DeviceName, ActionType, Domain, Url,
          InitiatingProcessFileName, InitiatingProcessAccountName
| order by Timestamp desc

DeviceEvents
| where Timestamp > ago(7d)
| where ActionType == "ExploitGuardNetworkProtectionBlocked"
| summarize Blocks = count() by DeviceName
| order by Blocks desc

DeviceEvents
| where Timestamp > ago(7d)
| where ActionType == "WebContentFilteringBlocked"
| extend d = parse_json(AdditionalFields)
| extend Domain = tostring(d.Domain), Category = tostring(d.Category)
| project Timestamp, DeviceName, Domain, Category, InitiatingProcessFileName
| order by Timestamp desc


DeviceEvents
| where Timestamp > ago(7d)
| where ActionType in ("ExploitGuardNetworkProtectionBlocked", "WebContentFilteringBlocked")
| extend d = parse_json(AdditionalFields)
| extend Domain   = tostring(d.Domain),
         Url      = tostring(d.Url),
         Category = tostring(d.Category)
| project Timestamp, DeviceName,
          Control = iff(ActionType == "WebContentFilteringBlocked", "WCF", "NetworkProtection"),
          Domain, Url, Category, InitiatingProcessFileName
| order by Timestamp desc


xxxcc




DeviceEvents
| where Timestamp > ago(24h)
| where ActionType in (
    "ExploitGuardNetworkProtectionBlocked",
    "ExploitGuardNetworkProtectionAudited",
    "WebContentFilteringBlocked"
)
| extend f = parse_json(AdditionalFields)
| extend Domain = tostring(f.Domain), Url = tostring(f.Url), Ip = tostring(f.Ip)
| where Domain =~ "owim.com" or Url has "owim.com"
   or Url has "www.owim.com"
| project Timestamp, DeviceName, ActionType, Domain, Url, Ip,
          InitiatingProcessFileName, InitiatingProcessAccountName
| order by Timestamp desc

DeviceNetworkEvents
| where Timestamp > ago(24h)
| where RemoteUrl has_any ("owim.com", "www.owim.com")
| project Timestamp, DeviceName, ActionType, RemoteUrl, RemoteIP, Protocol
| order by Timestamp desc

DeviceNetworkEvents
| where Timestamp > ago(24h)
| where RemoteUrl has "owim.com"
| project Timestamp, DeviceName, InitiatingProcessFileName, RemoteUrl, RemoteIP, ActionType
| order by Timestamp desc

DeviceEvents
| where Timestamp > ago(24h)
| where ActionType in ("ExploitGuardNetworkProtectionBlocked","ExploitGuardNetworkProtectionAudited")
| extend d = parse_json(AdditionalFields)
| extend Domain = tostring(d.Domain), Url = tostring(d.Url)
| where Domain =~ "owim.com" or Url has "owim.com"
| project Timestamp, DeviceName, ActionType, Domain, Url, InitiatingProcessFileName
| order by Timestamp desc